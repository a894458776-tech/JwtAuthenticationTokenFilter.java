<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kylin.kton.system.mapper.KtonMerchantConfigMapper">
    
    <resultMap type="KtonMerchantConfig" id="KtonMerchantConfigResult">
        <result property="merchantConfigId"    column="merchant_config_id"    />
        <result property="merchantId"    column="merchant_id"    />
        <result property="orderNotifyEnabled"    column="order_notify_enabled"    />
        <result property="dataUsageNotifyEnabled"    column="data_usage_notify_enabled"    />
        <result property="dataUsageFlowThreshold"    column="data_usage_flow_threshold"    />
        <result property="systemNotifyEnabled"    column="system_notify_enabled"    />
        <result property="riskDetectionEnabled"    column="risk_detection_enabled"    />
        <result property="riskDetectionBaseUrl"    column="risk_detection_base_url"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateTime"    column="update_time"    />
    </resultMap>

    <sql id="selectKtonMerchantConfigVo">
        select merchant_config_id, merchant_id, order_notify_enabled, data_usage_notify_enabled, data_usage_flow_threshold, system_notify_enabled, risk_detection_enabled, risk_detection_base_url, create_time, update_time from kton_merchant_config
    </sql>

    <select id="selectKtonMerchantConfigList" parameterType="KtonMerchantConfig" resultMap="KtonMerchantConfigResult">
        <include refid="selectKtonMerchantConfigVo"/>
        <where>  
            <if test="merchantId != null "> and merchant_id = #{merchantId}</if>
            <if test="orderNotifyEnabled != null "> and order_notify_enabled = #{orderNotifyEnabled}</if>
            <if test="dataUsageNotifyEnabled != null "> and data_usage_notify_enabled = #{dataUsageNotifyEnabled}</if>
            <if test="dataUsageFlowThreshold != null "> and data_usage_flow_threshold = #{dataUsageFlowThreshold}</if>
            <if test="systemNotifyEnabled != null "> and system_notify_enabled = #{systemNotifyEnabled}</if>
            <if test="riskDetectionEnabled != null "> and risk_detection_enabled = #{riskDetectionEnabled}</if>
            <if test="riskDetectionBaseUrl != null  and riskDetectionBaseUrl != ''"> and risk_detection_base_url = #{riskDetectionBaseUrl}</if>
        </where>
    </select>
    
    <select id="selectKtonMerchantConfigByMerchantConfigId" parameterType="Long" resultMap="KtonMerchantConfigResult">
        <include refid="selectKtonMerchantConfigVo"/>
        where merchant_config_id = #{merchantConfigId}
    </select>

    <insert id="insertKtonMerchantConfig" parameterType="KtonMerchantConfig" useGeneratedKeys="true" keyProperty="merchantConfigId">
        insert into kton_merchant_config
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="merchantId != null">merchant_id,</if>
            <if test="orderNotifyEnabled != null">order_notify_enabled,</if>
            <if test="dataUsageNotifyEnabled != null">data_usage_notify_enabled,</if>
            <if test="dataUsageFlowThreshold != null">data_usage_flow_threshold,</if>
            <if test="systemNotifyEnabled != null">system_notify_enabled,</if>
            <if test="riskDetectionEnabled != null">risk_detection_enabled,</if>
            <if test="riskDetectionBaseUrl != null">risk_detection_base_url,</if>
            <if test="createTime != null">create_time,</if>
            <if test="updateTime != null">update_time,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="merchantId != null">#{merchantId},</if>
            <if test="orderNotifyEnabled != null">#{orderNotifyEnabled},</if>
            <if test="dataUsageNotifyEnabled != null">#{dataUsageNotifyEnabled},</if>
            <if test="dataUsageFlowThreshold != null">#{dataUsageFlowThreshold},</if>
            <if test="systemNotifyEnabled != null">#{systemNotifyEnabled},</if>
            <if test="riskDetectionEnabled != null">#{riskDetectionEnabled},</if>
            <if test="riskDetectionBaseUrl != null">#{riskDetectionBaseUrl},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="updateTime != null">#{updateTime},</if>
         </trim>
    </insert>

    <update id="updateKtonMerchantConfig" parameterType="KtonMerchantConfig">
        update kton_merchant_config
        <trim prefix="SET" suffixOverrides=",">
            <if test="merchantId != null">merchant_id = #{merchantId},</if>
            <if test="orderNotifyEnabled != null">order_notify_enabled = #{orderNotifyEnabled},</if>
            <if test="dataUsageNotifyEnabled != null">data_usage_notify_enabled = #{dataUsageNotifyEnabled},</if>
            <if test="dataUsageFlowThreshold != null">data_usage_flow_threshold = #{dataUsageFlowThreshold},</if>
            <if test="systemNotifyEnabled != null">system_notify_enabled = #{systemNotifyEnabled},</if>
            <if test="riskDetectionEnabled != null">risk_detection_enabled = #{riskDetectionEnabled},</if>
            <if test="riskDetectionBaseUrl != null">risk_detection_base_url = #{riskDetectionBaseUrl},</if>
            <if test="createTime != null">create_time = #{createTime},</if>
            <if test="updateTime != null">update_time = #{updateTime},</if>
        </trim>
        where merchant_config_id = #{merchantConfigId}
    </update>

    <delete id="deleteKtonMerchantConfigByMerchantConfigId" parameterType="Long">
        delete from kton_merchant_config where merchant_config_id = #{merchantConfigId}
    </delete>

    <delete id="deleteKtonMerchantConfigByMerchantConfigIds" parameterType="String">
        delete from kton_merchant_config where merchant_config_id in 
        <foreach item="merchantConfigId" collection="array" open="(" separator="," close=")">
            #{merchantConfigId}
        </foreach>
    </delete>
</mapper>